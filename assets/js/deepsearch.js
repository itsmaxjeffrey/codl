!function(){const t=!1;const e=window.postMessage;console.log("start search.js");const n=new Set,r=/URI="(.*)"/,o=JSON.parse;async function i(e,n=0){let r=0;if(e){if(e instanceof Array&&16==e.length){if(e.every((function(t){return"number"==typeof t&&t<=256})))return void E({action:"ccScriptMsgAddKey",key:e,href:location.href,ext:"key"})}for(let o in e)if(0!=r&&(n=0),r++,"object"!=typeof e[o]){if("string"==typeof e[o]){if(M(e[o])){let t=m(e[o]);t&&E({action:"ccScriptMsgAddMedia",url:e[o],href:location.href,ext:t});continue}if("#EXTM3U"==e[o].substring(0,7).toUpperCase()){L(e[o])&&C(e[o]);continue}if("data:application/"==e[o].substring(0,17).toLowerCase()){const t=T(e[o].substring(17));t&&C(t);continue}if(e[o].toLowerCase().includes("urn:mpeg:dash:schema:mpd")){C(e[o],"mpd");continue}t}}else{if(e[o]instanceof Array&&16==e[o].length){e[o].every((function(t){return"number"==typeof t&&t<=256}))&&E({action:"ccScriptMsgAddKey",key:e[o],href:location.href,ext:"key"});continue}if(n>10)continue;i(e[o],++n)}}}JSON.parse=function(){let t=o.apply(this,arguments);return i(t),t},JSON.parse.toString=function(){return o.toString()};const s=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t){t=t.toUpperCase(),this.addEventListener("readystatechange",(function(e){if(200!=this.status)return;if("arraybuffer"==this.responseType&&this.response?.byteLength&&32==this.response.byteLength&&console.log(this.response),"arraybuffer"==this.responseType&&this.response?.byteLength&&16==this.response.byteLength&&E({action:"ccScriptMsgAddKey",key:this.response,href:location.href,ext:"key"}),""==this.response||"string"!=typeof this.response)return;if("data:application/"==this.response.substring(0,17).toLowerCase()){const t=T(this.response.substring(17));return void(t&&C(t))}if("data:application/"==this.responseURL.substring(0,17).toLowerCase()){const t=T(this.responseURL.substring(17));return void(t&&C(t))}if(M(this.response)){const t=m(this.response);return void(t&&E({action:"ccScriptMsgAddMedia",url:this.response,href:location.href,ext:t}))}if(this.response.toUpperCase().includes("#EXTM3U")){if("#EXTM3U"==this.response.substring(0,7))return"GET"==t?(C(k(U(this.responseURL),this.response)),void E({action:"ccScriptMsgAddMedia",url:this.responseURL,href:location.href,ext:"m3u8"})):void(L(this.response)&&C(this.response));if(x(this.response))return"GET"==t?void E({action:"ccScriptMsgAddMedia",url:this.responseURL,href:location.href,ext:"json"}):void C(this.response,"json")}const n=x(this.response);n&&i(n)})),s.apply(this,arguments)},XMLHttpRequest.prototype.open.toString=function(){return s.toString()};const c=window.fetch;window.fetch=async function(t,e){const n=await c.apply(this,arguments),r=n.clone();return n.arrayBuffer().then((n=>{if(16==n.byteLength)return void E({action:"ccScriptMsgAddKey",key:n,href:location.href,ext:"key"});let r=(new TextDecoder).decode(n);if(""==r)return;"object"==typeof t&&(t=t.url);let o=x(r);if(o)i(o);else{if("#EXTM3U"==r.substring(0,7).toUpperCase())return null==e?.method||e.method&&"GET"==e.method.toUpperCase()?(C(k(U(t),r)),void E({action:"ccScriptMsgAddMedia",url:t,href:location.href,ext:"m3u8"})):void(L(r)&&C(r));if("data:application/"!=r.substring(0,17).toLowerCase());else{const t=T(t.substring(0,17));t&&C(t)}}})),r},window.fetch.toString=function(){return c.toString()};const f=Array.prototype.slice;Array.prototype.slice=function(t,e){const n=f.apply(this,arguments);if(16==e&&32==this.length){for(let t of n)if("number"!=typeof t||t>255)return n;E({action:"ccScriptMsgAddKey",key:n,href:location.href,ext:"key"})}return n},Array.prototype.slice.toString=function(){return f.toString()};const a=Int8Array.prototype.subarray;Int8Array.prototype.subarray=function(t,e){const n=a.apply(this,arguments);if(16==n.byteLength){const t=new b(n);for(let e of t)if("number"!=typeof e||e>255)return n;E({action:"ccScriptMsgAddKey",key:t.buffer,href:location.href,ext:"key"})}return n},Int8Array.prototype.subarray.toString=function(){return a.toString()};const u=window.btoa;window.btoa=function(t){const e=u.apply(this,arguments);return 24==e.length&&"=="==e.substring(22,24)&&E({action:"ccScriptMsgAddKey",key:e,href:location.href,ext:"base64Key"}),"#EXTM3U"==t.substring(0,7).toUpperCase()&&L(t)&&C(t),e},window.btoa.toString=function(){return u.toString()};const p=window.atob;window.atob=function(t){const e=p.apply(this,arguments);return 24==t.length&&"=="==t.substring(22,24)&&E({action:"ccScriptMsgAddKey",key:t,href:location.href,ext:"base64Key"}),"#EXTM3U"==e.substring(0,7).toUpperCase()&&L(e)&&C(e),e.endsWith("</MPD>")&&C(e,"mpd"),e},window.atob.toString=function(){return p.toString()};const y=String.fromCharCode;let h="";String.fromCharCode=function(){const t=y.apply(this,arguments);if(t.length<7)return t;if("#EXTM3U"==t.substring(0,7)||t.includes("#EXTINF:"))return h+=t,h.includes("#EXT-X-ENDLIST")&&(C(h.split("#EXT-X-ENDLIST")[0]+"#EXT-X-ENDLIST"),h=""),t;const e=t.replaceAll("","");return 32==e.length&&E({action:"ccScriptMsgAddKey",key:e,href:location.href,ext:"key"}),t},String.fromCharCode.toString=function(){return y.toString()};const l=DataView;DataView=new Proxy(l,{construct(t,e){let n=new t(...e);if(n.setInt32=new Proxy(n.setInt32,{apply(t,e,n){Reflect.apply(t,e,n),16==e.byteLength&&E({action:"ccScriptMsgAddKey",key:e.buffer,href:location.href,ext:"key"})}}),16==n.byteLength&&16==n.buffer.byteLength&&E({action:"ccScriptMsgAddKey",key:n.buffer,href:location.href,ext:"key"}),256==n.byteLength||128==n.byteLength){const t=function(t,e){let n=new b(e);t=new b(t);for(let r=0;r<e;r++){n[r]=t[r];for(let n=r+e;n<t.byteLength;n+=e)if(t[r]!==t[n])return!1}return n.buffer}(n.buffer,16);t&&E({action:"ccScriptMsgAddKey",key:t,href:location.href,ext:"key"})}return n}});const g=window.escape;escape=function(t){return 24==t.length&&"=="==t.substring(22,24)&&E({action:"ccScriptMsgAddKey",key:t,href:location.href,ext:"base64Key"}),g(t)},escape.toString=function(){return g.toString()};const d=(t,e)=>{const n=Array.isArray(e[0])&&16===e[0].length,r=e[0]instanceof ArrayBuffer&&16===e[0].byteLength,o=new t(...e);return n||r?E({action:"ccScriptMsgAddKey",key:e[0],href:location.href,ext:"key"}):16===o.buffer.byteLength&&E({action:"ccScriptMsgAddKey",key:o.buffer,href:location.href,ext:"key"}),o},b=Uint8Array;window.Uint8Array=new Proxy(b,{construct:(t,e)=>d(t,e)});const w=Uint16Array;window.Uint16Array=new Proxy(w,{construct:(t,e)=>d(t,e)});const S=Uint32Array;window.Uint32Array=new Proxy(S,{construct:(t,e)=>d(t,e)});const A=Array.prototype.join;function M(t){return t.startsWith("http://")||t.startsWith("https://")}function L(t){let e=t.split("\n");for(let t of e)if("#"!=t[0])return!!M(t);return!1}function U(t){let e=t.split("/");return e.pop(),e.join("/")+"/"}function k(t,e){let n=e.split("\n");e="";for(let o of n)if(""!=o&&" "!=o&&"\n"!=o){if(o.includes("URI=")){let e=r.exec(o);e&&e[1]&&!M(e[1])&&(o=o.replace(r,'URI="'+t+e[1]+'"'))}"#"==o[0]||M(o)||(o=t+o),e+=o+"\n"}return e}function x(t){if("object"==typeof t)return t;if("string"==typeof t)try{return o(t)}catch(t){return!1}return!1}function m(t){let e;try{e=new URL(t)}catch(t){return}if(e=e.pathname.split("."),1!=e.length)return e=e[e.length-1].toLowerCase(),("m3u8"==e||"m3u"==e||"mpd"==e||"mp4"==e||"mp3"==e||"flv"==e||"key"==e)&&e}function C(t,e="m3u8"){E({action:"ccScriptMsgAddMedia",url:URL.createObjectURL(new Blob([new TextEncoder("utf-8").encode(t)])),href:location.href,ext:e})}function T(t){const e=["vnd.apple.mpegurl","x-mpegurl","mpegurl"];let n=!1;for(let r of e)if(t.substring(0,r.length).toLowerCase()==r){t=t.substring(r.length+1),n=!0;break}return!!n&&("base64,"==t.substring(0,7).toLowerCase()?p(t.substring(7)):t)}function E(t){let r=t.url?t.url:t.key;if(r instanceof ArrayBuffer||r instanceof Array){if(0==r.byteLength)return;t.key=function(t){try{let e=new b(t),n="";for(let t=0;t<e.byteLength;t++)n+=y(e[t]);return u(n)}catch(t){return!1}}(r),r=t.key}if(n.has(r))return!1;n.add(r),t.requestId=Date.now().toString()+n.size,e(t)}Array.prototype.join=function(){const t=A.apply(this,arguments);return"#EXTM3U"==t.substring(0,7).toUpperCase()&&L(t)&&C(t),t},Array.prototype.join.toString=function(){return A.toString()}}();