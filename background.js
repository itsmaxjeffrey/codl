(()=>{var e={500:(e,t,r)=>{"use strict";r.d(t,{G:()=>s,YA:()=>f,mu:()=>u,nI:()=>l});var n=r(809),a=r(649);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={initSyncComplete:!1,initLocalComplete:!1},u={init:!0};if(s.blackList=new Set,s.requestHeaders=new Map,s.customFoundUrls=new Map,chrome.tabs&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){e[0]&&e[0].id?s.tabId=e[0].id:s.tabId=-1})),s.OptionLists={Ext:[{ext:"flv",size:0,state:!0},{ext:"hlv",size:0,state:!0},{ext:"f4v",size:0,state:!0},{ext:"mp4",size:0,state:!0},{ext:"mp3",size:0,state:!0},{ext:"wma",size:0,state:!0},{ext:"wav",size:0,state:!0},{ext:"m4a",size:0,state:!0},{ext:"letv",size:0,state:!0},{ext:"ts",size:0,state:!1},{ext:"webm",size:0,state:!0},{ext:"ogg",size:0,state:!0},{ext:"ogv",size:0,state:!0},{ext:"acc",size:0,state:!0},{ext:"mov",size:0,state:!0},{ext:"mkv",size:0,state:!0},{ext:"m4s",size:0,state:!1},{ext:"m3u8",size:0,state:!0},{ext:"m3u",size:0,state:!0},{ext:"mpeg",size:0,state:!0},{ext:"avi",size:0,state:!0},{ext:"wmv",size:0,state:!0},{ext:"asf",size:0,state:!0},{ext:"movie",size:0,state:!0},{ext:"divx",size:0,state:!0},{ext:"mpeg4",size:0,state:!0},{ext:"vid",size:0,state:!0},{ext:"aac",size:0,state:!0},{ext:"mpd",size:0,state:!0}],Type:[{type:"audio/*",size:0,state:!0},{type:"video/*",size:0,state:!0},{type:"application/ogg",size:0,state:!0},{type:"application/vnd.apple.mpegurl",size:0,state:!0},{type:"application/x-mpegurl",size:0,state:!0},{type:"application/mpegurl",size:0,state:!0},{type:"application/octet-stream-m3u8",size:0,state:!0},{type:"application/dash+xml",size:0,state:!0},{type:"application/m4s",size:0,state:!0}],Regex:[{type:"ig",regex:"https://cache\\.video\\.[a-z]*\\.com/dash\\?tvid=.*",ext:"json",state:!1},{type:"ig",regex:".*\\.bilivideo\\.(com|cn).*\\/live-bvc\\/.*m4s",ext:"",blackList:!0,state:!1}],TitleName:!0,Player:"",MobileUserAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1",playbackRate:2,autoClearMode:2,userAgent:"",checkDuplicates:!0,enable:!0,BlockedDomains:null,popListCount:30,ShowCountOnIcon:!0},s.LocalVar={featMobileTabId:[],mediaControl:{tabid:0,index:-1}},s.isFirefox=!1,s.version=93,navigator.userAgent.includes("Chrome/")){var c=navigator.userAgent.match(/Chrome\/([\d]+)/);c&&c[1]&&(s.version=parseInt(c[1]))}else navigator.userAgent.includes("Firefox/")&&(s.isFirefox=!0);s.scriptList=new Map,s.scriptList.set("deepsearch.js",{key:"deepsearch",refresh:!0,allFrames:!0,world:"MAIN",name:"DeepSearch",off:"Close Search",tabId:new Set}),s.scriptList.set("screenrecorder.js",{key:"screenrecorder",refresh:!1,allFrames:!1,world:"ISOLATED",name:"ScreenRecorder",off:"Close Screen Recorder",tabId:new Set}),s.scriptList.set("webrtc.js",{key:"webrtc",refresh:!0,allFrames:!0,world:"MAIN",name:"Webrtc",off:"Close Webrtc",tabId:new Set});var l=/filename="?([^"]+)"?/;function d(){chrome.storage.local.get({MediaData:{}},(function(e){u=e.MediaData.init?{}:e.MediaData})),chrome.storage.sync.get(s.OptionLists,(function(e){chrome.runtime.lastError&&(e=s.OptionLists),e.Ext=new Map(e.Ext.map((function(e){return[e.ext,e]}))),e.Type=new Map(e.Type.map((function(e){return[e.type,{size:e.size,state:e.state}]}))),e.Regex=e.Regex.map((function(e){var t=void 0;try{t=new RegExp(e.regex,e.type)}catch(t){e.state=!1}return{regex:t,ext:e.ext,blackList:e.blackList,state:e.state}})),(s=i({},e,{},s)).popListCount||(s.popListCount=30),s.TitleName||(s.TitleName=!0),s.ShowCountOnIcon||(s.ShowCountOnIcon=!0);var t={path:s.enable?"assets/icons/64x64.png":"assets/icons/64x64_gray.png"};s.isFirefox?browser.browserAction&&browser.browserAction.setIcon(t):chrome.action&&chrome.action.setIcon(t),s.initSyncComplete=!0})),chrome.storage.local.get(s.LocalVar,(function(e){e.featMobileTabId=new Set(e.featMobileTabId),(s=i({},e,{},s)).initLocalComplete=!0}))}function f(){chrome.tabs.query({},(function(e){var t=[],r=!0,n=!1,a=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var c=o.value;t.push(c.id)}}catch(e){n=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}if(!u.init){var l=!1;for(var d in u)t.includes(parseInt(d))||(l=!0,delete u[d]);l&&chrome.storage.local.set({MediaData:u})}s.scriptList.forEach((function(e){e.tabId.forEach((function(r){t.includes(r)||e.tabId.delete(r)}))})),s.initLocalComplete&&chrome.declarativeNetRequest.getSessionRules((function(e){var r=!1,n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var c=i.value;t.includes(c.id)||(r=!0,s.featMobileTabId.delete(c.id),chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[c.id]}))}}catch(e){a=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}r&&chrome.storage.local.set({featMobileTabId:Array.from(s.featMobileTabId)})}))}))}d(),chrome.storage.onChanged.addListener((function(e,t){var r;if(e.MediaData)null!==(r=e.MediaData.newValue)&&void 0!==r&&r.init&&(u={});else for(var a=0,o=Object.entries(e);a<o.length;a++){var i=(0,n.Z)(o[a],2),c=i[0],l=i[1],d=(l.oldValue,l.newValue);d??=s.OptionLists[c],"Ext"!=c?"Type"!=c?"Regex"!=c?s[c]="featMobileTabId"!=c?d:new Set(d):s.Regex=d.map((function(e){var t=void 0;try{t=new RegExp(e.regex,e.type)}catch(t){e.state=!1}return{regex:t,ext:e.ext,blackList:e.blackList,state:e.state}})):s.Type=new Map(d.map((function(e){return[e.type,{size:e.size,state:e.state}]}))):s.Ext=new Map(d.map((function(e){return[e.ext,e]})))}})),chrome.runtime.onInstalled&&chrome.runtime.onInstalled.addListener((function(e){"update"==e.reason&&(chrome.storage.local.clear((function(){d()})),chrome.alarms.create("nowClear",{when:Date.now()+3e3}))}))},436:(e,t,r)=>{var n=r(540);e.exports=n},346:(e,t,r)=>{var n=/(<\/?[a-z][a-z0-9]*(?::[a-z][a-z0-9]*)?\s*(?:\s+[a-z0-9-_]+=(?:(?:'[\s\S]*?')|(?:"[\s\S]*?")))*\s*\/?>)|([^<]|<(?![a-z\/]))*/gi,a=/\s[a-z0-9-_]+\b(\s*=\s*('|")[\s\S]*?\2)?/gi,o=/(\s[a-z0-9-_]+\b\s*)(?:=(\s*('|")[\s\S]*?\3))?/gi,i=/^<[a-z]/,s=/\/>$/,u=/^<\//,c=/<\/?([a-z][a-z0-9]*)(?::([a-z][a-z0-9]*))?/i,l=/^('|")|('|")$/g,d=/^(?:area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/i,f=r(923);function p(e,t,r){for(var p,h,m,v,b,g,y,x,w=[],E=0,I=e.match(n),T=!1,k=null,S=0,_=I.length;S<_;S++)if(h=(x=I[S]).match(c),(p=t.test(x))&&!T&&(T=!0),T){if(i.test(x)){m=s.test(x)||d.test(h[1]),v=[];for(var L=0,O=(g=x.match(a)||[]).length;L<O;L++)o.lastIndex=0,b=o.exec(g[L]),v.push({name:b[1].trim(),value:(b[2]||"").trim().replace(l,"")});(k&&k.childNodes||w).push(y=new f({nodeType:1,nodeName:h[1],namespace:h[2],attributes:v,childNodes:[],parentNode:k,startTag:x,selfCloseTag:m})),E++,!r&&p&&k&&w.push(y),m?E--:k=y}else u.test(x)?k.nodeName==h[1]&&(k=k.parentNode,E--):k.childNodes.push(new f({nodeType:3,text:x,parentNode:k}));if(0==E&&(T=!1,k=null,r))break}return r?w[0]||null:w}function h(e){this.rawHTML=e}h.prototype.getElementsByClassName=function(e){var t=new RegExp("class=('|\")(.*?\\s)?"+e+"(\\s.*?)?\\1");return p(this.rawHTML,t)},h.prototype.getElementsByTagName=function(e){var t=new RegExp("^<"+e,"i");return p(this.rawHTML,t)},h.prototype.getElementById=function(e){var t=new RegExp("id=('|\")"+e+"\\1");return p(this.rawHTML,t,!0)},h.prototype.getElementsByName=function(e){return this.getElementsByAttribute("name",e)},h.prototype.getElementsByAttribute=function(e,t){var r=new RegExp("\\s"+e+"=('|\")"+t+"\\1");return p(this.rawHTML,r)},e.exports=h},540:(e,t,r)=>{var n=r(346);function a(){}a.prototype.parseFromString=function(e){return new n(e)},e.exports=a},923:e=>{function t(e){this.namespace=e.namespace||null,this.text=e.text,this._selfCloseTag=e.selfCloseTag,Object.defineProperties(this,{nodeType:{value:e.nodeType},nodeName:{value:1==e.nodeType?e.nodeName:"#text"},childNodes:{value:e.childNodes},firstChild:{get:function(){return this.childNodes[0]||null}},lastChild:{get:function(){return this.childNodes[this.childNodes.length-1]||null}},parentNode:{value:e.parentNode||null},attributes:{value:e.attributes||[]},innerHTML:{get:function(){for(var e,t="",r=0,n=this.childNodes.length;r<n;r++)t+=3===(e=this.childNodes[r]).nodeType?e.text:e.outerHTML;return t}},outerHTML:{get:function(){if(3!=this.nodeType){var e,t=(this.attributes.map((function(e){return e.name+(e.value?'="'+e.value+'"':"")}))||[]).join(" ");e="<"+this.nodeName+(t?" "+t:"")+(this._selfCloseTag?"/":"")+">",this._selfCloseTag||(e+=(this._selfCloseTag?"":this.childNodes.map((function(e){return e.outerHTML}))||[]).join(""),e+="</"+this.nodeName+">")}else e=this.textContent;return e}},textContent:{get:function(){return this.nodeType==t.TEXT_NODE?this.text:this.childNodes.map((function(e){return e.textContent})).join("").replace(/\x20+/g," ")}}})}function r(e,t,n){var a=[];if(n=!!n,3!==e.nodeType)for(var o=0,i=e.childNodes.length;o<i&&(3===e.childNodes[o].nodeType||!t(e.childNodes[o])||(a.push(e.childNodes[o]),!n));o++)a=a.concat(r(e.childNodes[o],t));return n?a[0]:a}t.prototype.getAttribute=function(e){for(var t=0,r=this.attributes.length;t<r;t++)if(this.attributes[t].name==e)return this.attributes[t].value;return null},t.prototype.getElementsByTagName=function(e){return r(this,(function(t){return t.nodeName==e}))},t.prototype.getElementsByClassName=function(e){var t=new RegExp("^(.*?\\s)?"+e+"(\\s.*?)?$");return r(this,(function(e){return e.attributes.length&&t.test(e.getAttribute("class"))}))},t.prototype.getElementById=function(e){return r(this,(function(t){return t.attributes.length&&t.getAttribute("id")==e}),!0)},t.prototype.getElementsByName=function(e){return r(this,(function(t){return t.attributes.length&&t.getAttribute("name")==e}))},t.ELEMENT_NODE=1,t.TEXT_NODE=3,e.exports=t},337:(e,t,r)=>{var n=r(501).default;function a(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var a=t&&t.prototype instanceof m?t:m,o=Object.create(a.prototype),s=new L(n||[]);return i(o,"_invoke",{value:T(e,r,s)}),o}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var h={};function m(){}function v(){}function b(){}var g={};d(g,u,(function(){return this}));var y=Object.getPrototypeOf,x=y&&y(y(O([])));x&&x!==r&&o.call(x,u)&&(g=x);var w=b.prototype=m.prototype=Object.create(g);function E(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function r(a,i,s,u){var c=p(e[a],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==n(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}})}function T(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return A()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var s=k(i,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=p(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function k(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=p(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function O(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:A}}function A(){return{value:void 0,done:!0}}return v.prototype=b,i(w,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:v,configurable:!0}),v.displayName=d(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,d(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},E(I.prototype),d(I.prototype,c,(function(){return this})),t.AsyncIterator=I,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new I(f(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(w),d(w,l,"Generator"),d(w,u,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=O,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;_(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:O(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},501:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},824:(e,t,r)=>{var n=r(337)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},793:(e,t,r)=>{"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:()=>n})},649:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(217);function a(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},809:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(13);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||(0,n.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},217:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(940);function a(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==(0,n.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,n.Z)(t)?t:String(t)}},940:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:()=>n})},13:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(793);function a(e,t){if(e){if("string"==typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(824),t=r.n(e);function n(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,u,"next",e)}function u(e){n(i,a,o,s,u,"throw",e)}s(void 0)}))}}var o=r(809),i=r(500);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=r(217);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(0,u.Z)(n.key),n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var d=r(793);var f=r(13);function p(e){return function(e){if(Array.isArray(e))return(0,d.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,f.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=r(649);const m=navigator.userAgent.includes("Chrome")?chrome:browser,v=e=>new Promise(((t,r)=>m.storage.sync.get(e,(n=>m.runtime.lastError?r(Error(m.runtime.lastError.message)):t(n?n[e]:void 0)))));function b(e,t){const r={};return r[e]=t,m.storage.sync.set(r)}function g(e,t){const r={};return r[e]=t,m.storage.local.set(r)}function y(e){return m.storage.local.remove(e)}function x(e,t,r){g(e,{value:t,expiry:(new Date).getTime()+r})}async function w(e){const t=await(e=>new Promise(((t,r)=>m.storage.local.get(e,(n=>m.runtime.lastError?r(Error(m.runtime.lastError.message)):t(n?n[e]:void 0))))))(e);if(!t)return null;return(new Date).getTime()>t.expiry?(y(e),null):t.value}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var I=function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=arguments.length>3?arguments[3]:void 0,n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,h.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),a=new AbortController;n.signal=a.signal;var o=setTimeout((function(){a.abort()}),t);return void 0!==(null==r?void 0:r.byteRangeStart)&&void 0!==(null==r?void 0:r.byteRangeEnd)&&(n.headers=n.headers||{},n.headers.Range="bytes=".concat(r.byteRangeStart,"-").concat(r.byteRangeEnd-1)),fetch(e,n).then((function(e){if(!e.ok)throw new Error("".concat(e.status,": ").concat(e.statusText));return e})).catch((function(e){throw"AbortError"===e.name?new Error("Response timed out"):new Error("Fetch error: ".concat(e.message))})).finally((function(){clearTimeout(o)}))},T=function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return I(t,r,n,arguments.length>4?arguments[4]:void 0).catch((function(o){if(1===a)throw o;return e(t,r,n,a-1)}))},k=function(e){var t=function(t){return(r=e,r.split("").map((function(e){return e.charCodeAt(0)}))).reduce((function(e,t){return e^t}),t);var r};return function(e){return e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})).map(t).map((function(e){return String.fromCharCode(e)})).join("")}};var S,_,L=(S=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("dailyDlCount");case 2:r=(r=e.sent)?parseInt(r)+1:1,n=60*(1440-60*(new Date).getHours()-(new Date).getMinutes())*1e3,x("dailyDlCount",r,n);case 6:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)}),O=(_=a(t().mark((function e(r){var n,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(r);case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Error fetching data. Status: ".concat(n.status));case 6:return e.next=8,n.arrayBuffer();case 8:return a=e.sent,e.abrupt("return",a);case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),function(e){return _.apply(this,arguments)});function A(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){return!1}}var P,R,M=(P=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N.runtime.setUninstallURL){e.next=12;break}return r=te(),e.next=4,X();case 4:e.t0=e.sent,e.t1=e.t0+"/",e.t2=ee.includes(r)?r+"/":"",e.t3=e.t1+e.t2,n=e.t3+"uninstalled.html",N.runtime.setUninstallURL(n),e.next=12;break;case 12:case"end":return e.stop()}}),e)}))),function(){return P.apply(this,arguments)}),D=(R=a(t().mark((function e(){var r,n,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:return(r=e.sent).dailycount||(r.dailycount=20),e.next=6,w("dailyDlCount");case 6:return(n=e.sent)&&n>r.dailycount&&G&&(a="exceeded.html"),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),function(){return R.apply(this,arguments)}),N=navigator.userAgent.includes("Chrome")?chrome:browser,G=!0,C=navigator.userAgent.includes("Firefox");var H,U,j,z,q,B,F=N.i18n.getMessage,V="speed",Z=function(){var e=a(t().mark((function e(){var r,n,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("option");case 2:r=e.sent,n={counter:0,priority:V,domain:{},rcounterr:0,recltime:30,reclsize:100};try{r&&Object.assign(n,r),n.counter=Math.max(0,Math.floor(Number(n.counter)||0)),n.rcounterr=Math.max(0,Math.floor(Number(n.rcounterr)||0)),K(n)}catch(e){(a=console).log.apply(a,p(logRED(e.stack)))}return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(e){b("option",e)},W=function(){var e=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="cococut.net",e.next=3,Z();case 3:return(n=e.sent).homedomain&&(r=n.homedomain),G||(r="127.0.0.1"),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=(H=a(t().mark((function e(){var r,n,a,o=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>0&&void 0!==o[0]&&o[0],n="https://cococut.net",e.next=4,Z();case 4:return(a=e.sent).homedomain&&(n="https://".concat(a.homedomain)),G||r||(n="http://127.0.0.1"),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)}))),function(){return H.apply(this,arguments)}),Y=(U=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://findit.cococut.net/",e.next=3,Z();case 3:return(n=e.sent).homedomain&&(r="https://findit.".concat(n.homedomain)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),j=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://merge-video-audio.cococut.net/",e.next=3,Z();case 3:return(n=e.sent).homedomain&&(r="https://merge-video-audio.".concat(n.homedomain,"/")),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),z=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="pro.cococut.net",e.next=3,Z();case 3:return(n=e.sent).prodomain&&(r=n.prodomain),G||(r="127.0.0.1"),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),function(){return z.apply(this,arguments)}),J=(q=a(t().mark((function e(){var r,n,a,o=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>0&&void 0!==o[0]&&o[0],n="https://pro.cococut.net",e.next=4,Z();case 4:return(a=e.sent).prodomain&&(n="https://".concat(a.prodomain)),G||r||(n="http://127.0.0.1"),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)}))),function(){return q.apply(this,arguments)}),$=(B=a(t().mark((function e(){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0="https://config.",e.next=3,W();case 3:return e.t1=e.sent,e.t2=e.t0.concat.call(e.t0,e.t1,"/config.json"),r=[e.t2,"https://config.cococut.net/config.json","https://parser-config.cocoshot.com/config.json"],G||(r=["http://127.0.0.1/pub/config/config.json"]),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)}))),function(){return B.apply(this,arguments)});var Q,ee=["zh_tw","zh_cn"];function te(){var e=N.i18n.getUILanguage();return e.match(/zh-CN/)?"zh_cn":e.match(/zh-TW/)?"zh_tw":e.startsWith("zh")?"zh_cn":e.startsWith("en")?e.substr(0,2):"other"}N.runtime.onInstalled&&N.runtime.onInstalled.addListener((Q=a(t().mark((function e(r){var n,a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N.runtime.getManifest(),a=te(),e.next=4,X();case 4:return e.t0=e.sent,e.t1=e.t0+"/",e.t2=ee.includes(a)?a+"/":"",e.t3=e.t1+e.t2,e.t4=e.t3+"installed.html?v=",e.t5=n.version,o=e.t4+e.t5,e.next=13,v("installed");case 13:if(e.sent){e.next=15;break}N.tabs.create({url:o},(function(e){b("installed","t")}));case 15:case"end":return e.stop()}}),e)}))),function(e){return Q.apply(this,arguments)})),M();var re,ne,ae,oe=/^https?:\/\/www\.youtube\.com\//,ie=(re=a(t().mark((function e(){var r,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("pui");case 2:if(!(r=e.sent)){e.next=9;break}if(n=k("CocoCut pro user"),"active"!=n(r).split("||")[3]){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)}))),function(){return re.apply(this,arguments)}),se=(ne=a(t().mark((function e(){var r,n,a,o,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=te(),e.t0="://",e.next=4,W();case 4:return e.t1=e.sent,n=e.t0.concat.call(e.t0,e.t1,"/"),a="other"!==r?"ahls.html":"oahls.html",e.next=9,D();case 9:return(o=e.sent)&&(a=o),e.next=13,ie();case 13:if(!e.sent){e.next=21;break}return e.t2="://",e.next=17,Y();case 17:e.t3=e.sent,n=e.t2.concat.call(e.t2,e.t3,"/"),a="ahls.vhtml","other"==r&&(a="oahls.vhtml");case 21:return i=G?n+(ee.includes(r)?r+"/":"")+a:"://127.0.0.1/"+a,e.abrupt("return",i);case 23:case"end":return e.stop()}}),e)}))),function(){return ne.apply(this,arguments)}),ue=(ae=a(t().mark((function e(){var r,n,a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=te(),e.t0="://",e.next=4,W();case 4:return e.t1=e.sent,n=e.t0.concat.call(e.t0,e.t1,"/"),a="other"!=r?"dlm.html":"odlm.html",e.next=9,ie();case 9:if(!e.sent){e.next=17;break}return e.t2="://",e.next=13,Y();case 13:e.t3=e.sent,n=e.t2.concat.call(e.t2,e.t3,"/"),a="dlm.vhtml","other"==r&&(a="odlm.vhtml");case 17:return o=G?n+"dlm/"+(ee.includes(r)?r+"/":"")+a:"://127.0.0.1/dlm/"+a,e.abrupt("return",o);case 19:case"end":return e.stop()}}),e)}))),function(){return ae.apply(this,arguments)}),ce=function(){function e(t,r){s(this,e),this.id=t,this.url=r.url,this.videoPageTitle=r.videoPageTitle,this.parentVideoPageTabId=r.parentVideoPageTabId,this.isM3U8dlPage=r.isM3U8dlPage,this.m3u8dlPageTabs=r.m3u8dlPageTabs}var r,n,i,u,c;return l(e,null,[{key:"create",value:function(t,r,n){var a=new e(t,r);return n[t]=a,e.saveTabs(n),a}},{key:"recover",value:function(t,r){var n=new e(t,r);return Object.assign(n,r),n}},{key:"saveTabs",value:(c=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x("workingTabs",r,864e5);case 2:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"getTabById",value:(u=a(t().mark((function r(n){var a;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w("workingTabs");case 2:if(!(a=t.sent)){t.next=5;break}return t.abrupt("return",e.recover(n,a[n]));case 5:case"end":return t.stop()}}),r)}))),function(e){return u.apply(this,arguments)})},{key:"getTabByM3u8dlPageTabId",value:(i=a(t().mark((function r(n){var a,i,s,u,c,l;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w("workingTabs");case 2:if(!(a=t.sent)){t.next=17;break}i=0,s=Object.entries(a);case 5:if(!(i<s.length)){t.next=17;break}if(u=(0,o.Z)(s[i],2),c=u[0],!(l=u[1]).isM3U8dlPage){t.next=9;break}return t.abrupt("continue",14);case 9:if(!l.m3u8dlPageTabs||!l.m3u8dlPageTabs.hasOwnProperty(n)){t.next=14;break}return a[c].m3u8dlPageTabs[n].isWorking=!0,t.next=13,e.saveTabs(a);case 13:return t.abrupt("return",e.recover(c,l));case 14:i++,t.next=5;break;case 17:case"end":return t.stop()}}),r)}))),function(e){return i.apply(this,arguments)})},{key:"removeTabById",value:(n=a(t().mark((function r(n){var a,o;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w("workingTabs");case 2:if(!(a=t.sent)){t.next=9;break}return null!=(o=a[n])&&o.isM3U8dlPage&&delete a[o.parentVideoPageTabId].m3u8dlPageTabs[n],delete a[n],t.next=9,e.saveTabs(a);case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),r)}))),function(e){return n.apply(this,arguments)})},{key:"m3u8dlPageNotFoundHandler",value:(r=a(t().mark((function r(n,a){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete a[n],t.next=3,e.removeTabById(n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),r)}))),function(e,t){return r.apply(this,arguments)})}]),e}();function le(e){return"m3u8"==e.ext||"m3u"==e.ext||"application/vnd.apple.mpegurl"==e.type||"application/x-mpegurl"==e.type||"application/mpegurl"==e.type||"application/octet-stream-m3u8"==e.type}function de(e,t){return t.TitleName?e.ext?e.title+"."+e.ext:e.title:e.name}var fe=navigator.userAgent.includes("Chrome")?chrome:browser,pe={FETCH_DOM:"FETCH_DOM",SET_HEADER:"ADD_HEADER",UNSET_HEADER:"UNSET_HEADER",KEEP_SET_HEADER:"KEEP_SET_HEADER",BLOCK_ONE_DOMAIN:"BLOCK_ONE_DOMAIN",SET_SPEEDUP_REC:"SET_SPEEDUP_REC",SET_USER_INFO:"SET_USER_INFO",DLM_NEW_TASK:"DLM_NEW_TASK",MESSAGEPIPE:"MESSAGEPIPE",BROADCASTPIPEMESSAGE:"BROADCASTPIPEMESSAGE",ONE2ONEMESSAGE:"ONE2ONEMESSAGE",GET_BG_OPTIONS:"GET_BG_OPTIONS",SET_BG_OPTIONS:"SET_BG_OPTIONS",M3U8DL_AJAX:"M3U8DL_AJAX",OPEN_M3U8DLPAGE:"OPEN_M3U8DLPAGE",HLSDLPAGE:{GET_parentVideoPageTabId:"GET_parentVideoPageTabId",ASK_VPAGE_START_CAPTURE:"ASK_VPAGE_START_CAPTURE",CAPTURE_STARTED:"CAPTURE_STARTED",VPAGE_CAPTURED_ONE_BUFFER:"VPAGE_CAPTURED_ONE_BUFFER",CAPTURE_ABORT:"CAPTURE_ABORT",CAPTURE_DONE:"CAPTURE_DONE",SEND_ONE_BUFFER_TO_DLPAGE:"SEND_ONE_BUFFER_TO_DLPAGE",SET_HLSDL_HEADERS:"SET_HLSDL_HEADERS",GET_MPD_M3U8_TEXT:"GET_MPD_M3U8_TEXT"}};function he(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];fe.runtime.onMessage.addListener((function(n,a,o){var i=n.eventName,s=n.data;return i===e&&(t(s,o,a),!!r||void 0)}))}var me=function(){var e=a(t().mark((function e(r,n){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe.runtime.sendMessage({eventName:r,data:n});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),ve=(function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.FETCH_DOM,r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.SET_HEADER,r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.UNSET_HEADER,r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.KEEP_SET_HEADER,r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.SET_USER_INFO,r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:me(pe.MESSAGEPIPE,r);case 1:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.GET_BG_OPTIONS);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:me(pe.SET_BG_OPTIONS,r);case 1:case"end":return e.stop()}}),e)})))}(),function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(pe.M3U8DL_AJAX,r);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))}(),r(436)),be=r.n(ve);function ge(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!0,n=!1,a=void 0;try{for(var o,i=document.querySelectorAll("div.hlsparserhelper")[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){o.value.remove()}}catch(e){n=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}var s=document.createElement("div");s.classList.add("hlsparserhelper");var u=document.createElement("iframe");s.append(u),t?(s.style.setProperty("width","0px"),s.style.setProperty("height","0px"),s.style.display="none",u.style.setProperty("width","0px"),u.style.setProperty("height","0px")):(s.style.setProperty("width","100%"),s.style.setProperty("height","100%")),u.src=e,u.allowTransparency="true",document.body.append(s)}var ye=function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=xe.runtime.getURL("dlmiframe.html?tabid="+r),e.next=3,xe.scripting.executeScript({target:{tabId:r},func:ge,args:[n,!0]});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=xe||navigator.userAgent.includes("Chrome")?chrome:browser,we={sendTab:function(e,t,r){return xe.tabs.sendMessage(parseInt(r),{method:e+"@myAd",data:t})},receive:function(e,r){return xe.runtime.onMessage.addListener(function(){var n=a(t().mark((function n(a,o){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.method!==e+"@myAd"){t.next=6;break}if("newDlMContentOk"!=e){t.next=5;break}return t.next=5,ye(o.tab.id);case 5:r(a.data);case 6:case"end":return t.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}};function Ee(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;xe.tabs.create({url:t},(function(t){e.dlmPageTabId=t.id,we.receive("newDlMContentOk",(function(n){we.sendTab("initDlmHelperFrameBegin",{msgData:e,threads:r,dlmPageId:n},t.id)}))}))}var Ie,Te=function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=chrome.runtime.getURL(r),e.next=3,chrome.runtime.getContexts({contextTypes:["OFFSCREEN_DOCUMENT"],documentUrls:["chrome-extension://".concat(chrome.runtime.id,"/").concat(r),n]});case 3:if(!(e.sent.length>0)){e.next=6;break}return e.abrupt("return");case 6:if(!Ie){e.next=11;break}return e.next=9,Ie;case 9:e.next=15;break;case 11:return Ie=chrome.offscreen.createDocument({url:r,reasons:["BLOBS"],justification:"reason for needing the document"}),e.next=14,Ie;case 14:Ie=null;case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke=function(e){return function(){return!!chrome.runtime.lastError}},Se=function(){var e=a(t().mark((function e(r,n){var a,o,i,s,u,c,l;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=n||r.type,a=n?new Blob([r],{type:n}):new Blob([r]),o="offscreen.html",e.next=5,Te(o);case 5:return i=[chrome.runtime.getURL(o),"".concat(chrome.runtime.id,"/").concat(o),o],e.next=8,clients.matchAll({includeUncontrolled:!0});case 8:return e.t0=function(e){return i.some((function(t){return e.url.includes(t)}))},s=e.sent.find(e.t0),u=new MessageChannel,s.postMessage(a,[u.port2]),e.next=14,new Promise((function(e){return u.port1.onmessage=e}));case 14:return c=e.sent,l=c.data,e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),_e=function(){var e=a(t().mark((function e(r){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,chrome.scripting.executeScript({target:{tabId:r,allFrames:!0},injectImmediately:!0,func:function(){var e=[];try{var t=!0,r=!1,n=void 0;try{for(var a,o=self.jwplayer().getPlaylist()[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=a.value;e.push({initiator:location.href,url:new URL(i.file,location.href).href,timeStamp:performance.timing.domComplete,source:"jwplayer"})}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}}catch(e){}return e},world:"MAIN"});case 3:return n=e.sent,e.abrupt("return",n.map((function(e){return e.result})).flat().filter((function(e){return e})));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Le={ajax:function(e){return a(t().mark((function r(){var n,a;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},"file"===(e=e||{}).type&&(n.responseType="arraybuffer"),t.next=5,T(e.url,n,15e3,3,e.range).then((function(t){if(t.ok)return"file"===e.type?t.blob():t.text();throw new Error("".concat(t.status,": ").concat(t.statusText))})).then((function(e){a={OK:!0,data:e}})).catch((function(e){a={errorMsg:e.message}}));case 5:if("file"!==e.type||!a.OK){t.next=9;break}return t.next=8,Se(a.data);case 8:a.data=t.sent;case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),r)})))()}},Oe=function(){var e=a(t().mark((function e(r,n,a){var o,i,s,u,c,l,d,f;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=function(e,t){var r=e.m3u8dlPageTabs;for(var n in r){if(r[n].m3u8Data.m3u8Url===t)return parseInt(n)}return null},e.prev=1,e.next=4,Pe();case 4:o=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",n(F("TbgTryLater")));case 10:if(i=r.id,s=r.index,u=r.url,c=r.title,!oe.exec(u)){e.next=16;break}return e.abrupt("return",n({msg:"Do not support this webpage"}));case 16:if((l=o[i])||(l=ce.create(i,{url:u,m3u8dlPageTabs:{},videoPageTitle:c},o)),u.startsWith("http")){e.next=20;break}return e.abrupt("return",n({msg:F("TbgTryLater")}));case 20:if(!l.isM3U8dlPage){e.next=22;break}return e.abrupt("return",n({msg:F("TbgIsDownloading")}));case 22:if(a){e.next=25;break}return Ae(i,s,l,o),e.abrupt("return",n({msg:F("Tloading")}));case 25:return(f=d(l,a.m3u8Url))?De(f,i,s,l,o,a):Ae(i,s,l,o,a),e.abrupt("return",n({msg:F("Tloading")}));case 28:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),Ae=function(){var e=a(t().mark((function e(r,n,o,i,s){var u,c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=G?"https":"http",e.next=3,se();case 3:c=e.sent,Re.tabs.create({url:u+c+"?vtid="+r,index:n+1,active:!0},function(){var e=a(t().mark((function e(n){var a,l,d;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.url||n.pendingUrl,C&&(a=u+c),l=n.id,o.m3u8dlPageTabs[l]={m3u8Data:s},ce.create(n.id,{url:a,parentVideoPageTabId:r,isM3U8dlPage:!0},i),e.next=7,Z();case 7:(d=e.sent).counter++,K(d),L();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),Pe=function(){var e=a(t().mark((function e(){var r,n,a,i,s,u,c,l;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},e.next=3,w("workingTabs");case 3:if(n=e.sent)for(a=0,i=Object.entries(n);a<i.length;a++)s=(0,o.Z)(i[a],2),u=s[0],c=s[1],l=ce.recover(u,c),r[u]=l;return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Re=navigator.userAgent.includes("Chrome")?chrome:browser;function Me(e,t){Re.tabs.query({active:!0,lastFocusedWindow:!0},(function(r){Oe(r[0],t,e)}))}function De(e,r,n,o,i,s){var u=function(){var u=a(t().mark((function a(){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete i[r].m3u8dlPageTabs[e],t.next=3,ce.m3u8dlPageNotFoundHandler(e,i);case 3:Ae(r,n,o,i,s);case 4:case"end":return t.stop()}}),a)})));return function(){return u.apply(this,arguments)}}();chrome.tabs.get(e,function(){var n=a(t().mark((function n(a){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.runtime.lastError||!a?u():i[r].m3u8dlPageTabs[e].isWorking?Re.tabs.update(e,{active:!0},ke("update m3u8dlPageTab")):u();case 1:case"end":return t.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}var Ne=function(){function e(){if(s(this,e),e.instance)return e.instance;e.instance=this,this.fixedRuleIds={blockAdsense:30086,blockAds:30087}}return l(e,[{key:"updateSessionRules",value:function(){var e=a(t().mark((function e(r,n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:n,addRules:r});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateDynamicRules",value:function(){var e=a(t().mark((function e(r,n,a){var o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:n,addRules:r});case 3:o=e.sent,a&&a(o),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"filterDynamicRules",value:function(e){chrome.declarativeNetRequest.getDynamicRules((function(t){e&&e(t)}))}}],[{key:"hlsMheaderRuleId",get:function(){return 30088}}]),e}();function Ge(){chrome.alarms.create("checkAndRemoveExpiredItems",{delayInMinutes:1,periodInMinutes:10}),chrome.alarms.onAlarm.addListener((function(e){"checkAndRemoveExpiredItems"===e.name&&chrome.storage.local.get(null,(function(e){Object.keys(e).forEach((function(t){var r=e[t],n=(new Date).getTime();r.expirationAutoClear&&n>r.expirationAutoClear&&chrome.storage.local.remove(t,(function(){}))}))}))}))}Ne.getInstance=function(){return Ne.instance||(Ne.instance=new Ne),Ne.instance};var Ce,He,Ue=function(){var e=a(t().mark((function e(r){var n,a,o,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:if(n=e.sent,a={homeDomain:"",prodomain:"",durationMax:""},r.others&&(a=r.others),!a.homeDomain){e.next=14;break}return e.next=10,je(a.homeDomain);case 10:o=e.sent,n.homedomain=o||"",e.next=16;break;case 14:n.homedomain="";case 16:if(!a.prodomain){e.next=23;break}return e.next=19,je(a.prodomain);case 19:i=e.sent,n.prodomain=i||"",e.next=25;break;case 23:n.prodomain="";case 25:a.durationMax&&(n.durationMax=a.durationMax),K(n);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=a(t().mark((function e(r){var n,a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe();case 2:n=e.sent,a=0;case 4:if(!(a<r.geos.length)){e.next=15;break}if("*"!==(o=r.geos[a])){e.next=10;break}return e.abrupt("return",r.domain);case 10:if(!n||n!=o){e.next=12;break}return e.abrupt("return",r.domain);case 12:a++,e.next=4;break;case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=a(t().mark((function e(r){var n,a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe();case 2:return n=e.sent,e.next=5,w("geoNotice");case 5:if(a=e.sent,o=r.ttl||24,!r[n]){e.next=13;break}if(!a||a!==r[n]){e.next=10;break}return e.abrupt("return");case 10:x("geoNotice",r[n],36e5*o),e.next=16;break;case 13:if(!a||a!==r.default){e.next=15;break}return e.abrupt("return");case 15:x("geoNotice",r.default,36e5*o);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=a(t().mark((function e(){var r,n,a,o,i,s,u;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(!0);case 2:return r=e.sent,n=["".concat(r,"/show-geo/"),"https://pro.cococut.net/show-geo/","https://geo.cocoshot.com/show-geo/"],a=0,e.next=7,w("geo");case 7:if(!(o=e.sent)){e.next=12;break}return e.abrupt("return",o);case 12:if(!(a<n.length)){e.next=32;break}return e.prev=13,e.next=16,fetch(n[a]);case 16:return i=e.sent,e.next=19,i.text();case 19:return s=e.sent,x("geo",u=s.split("/show-geo/:")[1].toLowerCase(),864e5),e.abrupt("return",u);case 26:e.prev=26,e.t0=e.catch(13),a++;case 30:e.next=12;break;case 32:case"end":return e.stop()}}),e,null,[[13,26]])})));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=a(t().mark((function e(r){var n,a,o,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.serverNotice&&g("serverNotice",r.serverNotice),!r.recltime){e.next=6;break}return e.next=4,Z();case 4:(n=e.sent).recltime!==r.recltime&&(n.recltime=r.recltime,K(n));case 6:if(!r.waittime){e.next=11;break}return e.next=9,Z();case 9:(a=e.sent).waittime!==r.waittime&&(a.waittime=r.waittime,K(a));case 11:if(!r.dailycount){e.next=16;break}return e.next=14,Z();case 14:(o=e.sent).dailycount!==r.dailycount&&(o.dailycount=r.dailycount,K(o));case 16:if(!r.reclsize){e.next=21;break}return e.next=19,Z();case 19:(i=e.sent).reclsize!==r.reclsize&&(i.reclsize=r.reclsize,K(i));case 21:Ue(r),r.notices?ze(r.notices):y("geoNotice");case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=a(t().mark((function e(r){var n,a,o,i,s,u,c,l;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.url,a=r.domLabel,o=r.reqInit,i=r.fetchTimeout,s=r.retryCount,e.next=3,T(n,o,i,s).then((function(e){if(e.ok)return e.text();throw new Error(e.statusText)})).then((function(e){if(c=e,a){var t=(new(be())).parseFromString(e,"text/html");u=t.querySelector(a),l={}}})).catch((function(e){return l={url:n,err:e.toString()},!1}));case 3:if(l){e.next=7;break}return e.abrupt("return",{dom:u,originHtml:c});case 7:return e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=a(t().mark((function e(r){var n,a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(r);case 2:if(!(n=e.sent).hasOwnProperty("err")){e.next=5;break}return e.abrupt("return",n);case 5:if(a=n.dom,o=n.originHtml,!r.domLabel){e.next=11;break}if(!a){e.next=9;break}return e.abrupt("return",a.innerHTML);case 9:e.next=13;break;case 11:if(!o){e.next=13;break}return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=a(t().mark((function e(r){var n,a,o=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:1e4,a="unsetHeaderTimeoutHandle_".concat(r),e.next=4,chrome.alarms.get(a);case 4:if(!e.sent){e.next=8;break}n/=6e4,chrome.alarms.clear(a),chrome.alarms.create(a,{delayInMinutes:parseInt(n)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ke=function(){var e=a(t().mark((function e(r){var n,a,i,s,u,c,l,d;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=r.oneHeadDomain,a=r.oneHeadValue,et.push(n),et=p(new Set(et)),i=0,s=Object.entries(a);i<s.length;i++)u=(0,o.Z)(s[i],2),c=u[0],l=u[1],tt.hasOwnProperty(c)||(tt[c]=l);nt(r.ruleId),r.keepTime&&(d="unsetHeaderTimeoutHandle_".concat(r.ruleId),chrome.alarms.create(d,{delayInMinutes:parseInt(r.keepTime)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=a(t().mark((function e(r,n){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve(r);case 2:a=e.sent,n({type:"repDom",theFetchResp:a});case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Xe=function(){var e=a(t().mark((function e(r){var n,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.oneDomain,r.tabId,r.mediaId,r.oneEleIndex,e.next=3,v("BlockedDomains");case 3:(a=e.sent)||(a=[]),a.push(n),b("BlockedDomains",a=p(new Set(a)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=a(t().mark((function e(r,n){var a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.tab.id,e.next=3,ce.getTabByM3u8dlPageTabId(a);case 3:o=e.sent,r.checked?chrome.scripting.executeScript({target:{tabId:o.id,allFrames:!0},func:function(){window.changeTime||videoTimeHook_(window),changeTime(2,0,!0)}}):chrome.scripting.executeScript({target:{tabId:o.id,allFrames:!0},func:function(){changeTime(0,0,!1,!0)}});case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Je=function(){var e=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r?b("pui",r):(t="pui",m.storage.sync.remove(t));case 1:case"end":return e.stop()}var t}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=(Ce=a(t().mark((function e(){var r,n,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,e.next=3,$();case 3:n=e.sent,o=function(){var e=a(t().mark((function e(){var a,i,s,u,c;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new Date,i=a.toISOString().split("T")[0],s=Math.floor(a.getTime()/36e5),e.next=6,fetch(n[r]+"?v="+i+"_"+s);case 6:return u=e.sent,e.next=9,u.json();case 9:c=e.sent,Be(c),e.next=20;break;case 13:if(e.prev=13,e.t0=e.catch(0),!(r<n.length-1)){e.next=20;break}return r++,e.next=20,o();case 20:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),o();case 6:case"end":return e.stop()}}),e)}))),function(){return Ce.apply(this,arguments)}),Qe=(He=a(t().mark((function e(){var r,n,a,o,i,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ne.getInstance(),e.t0=URL,e.next=4,X();case 4:return e.t1=e.sent,n=new e.t0(e.t1),e.next=8,Z();case 8:if(a=e.sent,o=r.fixedRuleIds,i=[o.blockAds,o.blockAdsense],!(a.counter>30)){e.next=14;break}return r.updateDynamicRules(null,i,null),e.abrupt("return");case 14:s=[{id:r.fixedRuleIds.blockAdsense,priority:1,action:{type:"block"},condition:{initiatorDomains:[n.host],urlFilter:"*pagead2*"}},{id:r.fixedRuleIds.blockAds,priority:1,action:{type:"block"},condition:{initiatorDomains:[n.host],urlFilter:"*cococut_promotion*",resourceTypes:["xmlhttprequest"]}}],r.filterDynamicRules((function(e){var t=!1;if(e){var n=e.map((function(e){return e.id}));i.forEach((function(e){n.includes(e)||(t=!0)}))}t&&r.updateDynamicRules(s,i,(function(){}))}));case 16:case"end":return e.stop()}}),e)}))),function(){return He.apply(this,arguments)}),et=[],tt={},rt=[];function nt(e){if(et&&tt){for(var t=[],r=0,n=Object.entries(tt);r<n.length;r++){var a=(0,o.Z)(n[r],2),i=a[0],s=a[1];-1!==i.indexOf("SetItse2-")&&(i=i.split("SetItse2-")[1]);var u={header:i,operation:"set",value:s};t.push(u)}for(var c=[],l=[],d=0,f=et;d<f.length;d++){var p=f[d];p.indexOf("*")>-1?l.push(p):c.push(p)}rt.push(e);for(var h=[{id:e,action:{type:"modifyHeaders",responseHeaders:t},condition:{initiatorDomains:c}}],m=0,v=l;m<v.length;m++){var b=v[m];e+=1,rt.push(e);var g={id:e,action:{type:"modifyHeaders",responseHeaders:t},condition:{urlFilter:b}};h.push(g)}chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:rt,addRules:h})}}function at(e){rt.push(e),chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:rt})}function ot(){he(pe.SET_HEADER,(function(e,t){Ke(e)})),he(pe.FETCH_DOM,(function(e,t){We(e,t)}),!0),he(pe.UNSET_HEADER,(function(e,t){at(e.ruleId)})),he(pe.KEEP_SET_HEADER,(function(e,t){Ze(e.keepTime,e.ruleId)})),he(pe.BLOCK_ONE_DOMAIN,(function(e,t){Xe(e)})),he(pe.SET_SPEEDUP_REC,(function(e,t,r){Ye(e,r)})),he(pe.SET_USER_INFO,(function(e,t){Je(e)})),he(pe.DLM_NEW_TASK,function(){var e=a(t().mark((function e(r,n){var a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=G&&r.url.startsWith("https://")?"https":"http",o=2,e.next=4,ie();case 4:if(!e.sent){e.next=6;break}o=4;case 6:return e.t0=Ee,e.t1=r,e.t2=a,e.next=11,ue();case 11:e.t3=e.sent,e.t4=e.t2+e.t3,e.t5=o,(0,e.t0)(e.t1,e.t4,e.t5);case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),he(pe.MESSAGEPIPE,(function(e,t){if(e.one2one)chrome.tabs.sendMessage(parseInt(e.toTabId),{eventName:pe.ONE2ONEMESSAGE,data:e.data});else{var r={eventName:pe.BROADCASTPIPEMESSAGE,data:e};chrome.tabs.query({},(function(e){for(var t=0;t<e.length;++t)chrome.tabs.sendMessage(e[t].id,r)}))}})),he(pe.GET_BG_OPTIONS,function(){var e=a(t().mark((function e(r,n){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:a=e.sent,n(a);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),!0),he(pe.SET_BG_OPTIONS,(function(e,t){K(e)})),he(pe.M3U8DL_AJAX,function(){var e=a(t().mark((function e(r,n,a){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.ajax(r).then((function(e){n(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),!0),he(pe.OPEN_M3U8DLPAGE,(function(e,t,r){t(Me(e,t))}),!0),he(pe.HLSDLPAGE.GET_parentVideoPageTabId,function(){var e=a(t().mark((function e(r,n,a){var o,i,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.tab.id,e.next=3,ce.getTabByM3u8dlPageTabId(o);case 3:i=e.sent,s=i?i.id:null,n({videoTabId:s,m3u8dlPageTabId:o});case 6:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),!0),he(pe.HLSDLPAGE.ASK_VPAGE_START_CAPTURE,function(){var e=a(t().mark((function e(r,n,a){var o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return chrome.scripting.executeScript({target:{tabId:r.videoTabId,allFrames:!0},func:function(e){localStorage.m3u8dlPageTabId=e.m3u8dlPageTabId,location.reload()},args:[r]}),e.next=3,Z();case 3:(o=e.sent).rcounterr++,K(o),chrome.tabs.update(r.videoTabId,{active:!0},ke("focus on video page for capture"));case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()),he(pe.HLSDLPAGE.VPAGE_CAPTURED_ONE_BUFFER,function(){var e=a(t().mark((function e(r,n,a){var o,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(r.blobUrl);case 2:return o=e.sent,e.next=5,Se(o);case 5:i=e.sent,r.blobUrl=i,chrome.tabs.sendMessage(parseInt(r.m3u8dlPageTabId),{eventName:pe.HLSDLPAGE.SEND_ONE_BUFFER_TO_DLPAGE,data:r});case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()),he(pe.HLSDLPAGE.CAPTURE_ABORT,(function(e,t,r){chrome.tabs.sendMessage(parseInt(e.m3u8dlPageTabId),{eventName:pe.HLSDLPAGE.CAPTURE_ABORT,data:e}),it(r.tab.id)})),he(pe.HLSDLPAGE.CAPTURE_DONE,(function(e,t,r){chrome.tabs.sendMessage(parseInt(e.m3u8dlPageTabId),{eventName:pe.HLSDLPAGE.CAPTURE_DONE,data:e}),it(r.tab.id)})),he(pe.HLSDLPAGE.SET_HLSDL_HEADERS,(function(e,t,r){!function(e){var t=[e.ruleId],r=[];if(!function(e){if(null==e)return!0;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(e.reqHeadersKV)){var n=Object.keys(e.reqHeadersKV).map((function(t){return{header:t,operation:"set",value:e.reqHeadersKV[t]}}));r.push({id:e.ruleId,action:{type:"modifyHeaders",requestHeaders:n},condition:{resourceTypes:["xmlhttprequest","media","image"],requestDomains:e.requestDomains}})}Ne.getInstance().updateSessionRules(r,t)}(e)}))}function it(e){chrome.scripting.executeScript({target:{tabId:e,allFrames:!0},func:function(){localStorage.removeItem("m3u8dlPageTabId")}})}chrome.alarms.onAlarm.addListener((function(e){e.name.indexOf("unsetHeaderTimeoutHandle_")>-1&&at(e.name.split("_")[1])}));var st=function(){var e=a(t().mark((function e(r){var n,a,o,s,u,c,l,d;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(r);case 2:for(n=e.sent,a=!0,o=!1,s=void 0,e.prev=6,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)l=c.value,(d=i.G.customFoundUrls.get(r))||(d=new Map,i.G.customFoundUrls.set(r,d)),d.set(l.url,l);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),o=!0,s=e.t0;case 14:e.prev=14,e.prev=15,a||null==u.return||u.return();case 17:if(e.prev=17,!o){e.next=20;break}throw s;case 20:return e.finish(17);case 21:return e.finish(14);case 22:case"end":return e.stop()}}),e,null,[[6,10,14,22],[15,,17,21]])})));return function(t){return e.apply(this,arguments)}}(),ut=function(){var e=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=r.tips?(r.tips=r.tips?"*":"",chrome.action.setIcon({path:{16:"assets/icons/16x16.png",32:"assets/icons/32x32.png",48:"assets/icons/48x48.png",64:"assets/icons/64x64.png",128:"assets/icons/128x128.png"}}),chrome.action.setBadgeText({text:r.tips})):0==r.number||null==r.number?(chrome.action.setBadgeText({text:"",tabId:r.tabId},(function(){chrome.runtime.lastError})),chrome.action.setTitle({title:"CocoCut",tabId:r.tabId},(function(){chrome.runtime.lastError})),chrome.action.setIcon({path:{16:"assets/icons/16x16_gray.png",32:"assets/icons/32x32_gray.png",48:"assets/icons/48x48_gray.png",64:"assets/icons/64x64_gray.png",128:"assets/icons/128x128_gray.png"}})):(chrome.action.setIcon({path:{16:"assets/icons/16x16.png",32:"assets/icons/32x32.png",48:"assets/icons/48x48.png",64:"assets/icons/64x64.png",128:"assets/icons/128x128.png"}}),i.G.ShowCountOnIcon&&(r.number=r.number>99?"99+":r.number.toString(),chrome.action.setBadgeText({text:r.number,tabId:r.tabId},(function(){chrome.runtime.lastError}))),chrome.action.setTitle({title:F("TbadgetTitle",[r.number]),tabId:r.tabId},(function(){chrome.runtime.lastError})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=void 0,lt=0,dt=0;function ft(e){var r,n,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!oe.exec(e.url)&&!c)if(i.G&&i.G.initSyncComplete&&i.G.initLocalComplete&&null!=i.G.tabId&&!i.mu.init){if(i.G.enable)if(s||!i.G.blackList.has(e.requestId)){if(!("null"!=e.initiator&&null!=e.initiator&&vt(e.initiator)||i.G.isFirefox&&e.originUrl&&vt(e.originUrl)||vt(e.url))){var l=new URL(e.url);if(i.G.BlockedDomains)for(var d=new URL(e.url),f=0;f<i.G.BlockedDomains.length;f++){var p=i.G.BlockedDomains[f].toLowerCase();if(d.host==p)return}var h=mt(l.pathname),m=(0,o.Z)(h,2),v=m[0],b=m[1];if(e.tabId=-1==e.tabId?i.G.tabId:e.tabId,null!==(r=i.G.customFoundUrls.get(e.tabId))&&void 0!==r&&r.has(e.url)){u=!0;var g=i.G.customFoundUrls.get(e.tabId).get(e.url);e.initiator=g.initiator?g.initiator:e.initiator,b="m3u8"}else{if(s&&!u){for(var y in i.G.Regex)if(i.G.Regex[y].state){i.G.Regex[y].regex.lastIndex=0;var x=i.G.Regex[y].regex.exec(e.url);if(null!=x)return i.G.Regex[y].blackList?void i.G.blackList.add(e.requestId):(e.extraExt=i.G.Regex[y].ext?i.G.Regex[y].ext:void 0,1==x.length||(x.shift(),(x=x.map((function(e){return decodeURIComponent(e)})))[0].startsWith("https://")||x[0].startsWith("http://")||(x[0]=l.protocol+"//"+e.url),e.url=x.join("")),void ft(e,!0,!0))}return}if(!s){var w,E,I,T;if(e.header=function(e){var t={};if(null==e.responseHeaders||0==e.responseHeaders.length)return t;var r=!0,n=!1,a=void 0;try{for(var o,i=e.responseHeaders[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var s=o.value;if(s.name=s.name.toLowerCase(),"content-length"==s.name)t.size??=parseInt(s.value);else if("content-type"==s.name)t.type=s.value.split(";")[0].toLowerCase();else if("content-disposition"==s.name)t.attachment=s.value;else if("content-range"==s.name){var u=s.value.split("/")[1];"*"!==u&&(t.size=parseInt(u))}}}catch(e){n=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}return t}(e),!u&&null!=b)if("break"==(u=ht(b,null===(I=e.header)||void 0===I?void 0:I.size)))return;if(!u&&null!=(null===(w=e.header)||void 0===w?void 0:w.type))if("break"==(u=function(e,t){var r=i.G.Type.get(e.split("/")[0]+"/*")||i.G.Type.get(e);if(!r)return!1;if(!r.state)return"break";if(0!=r.size&&null!=t&&t<=1024*r.size)return"break";return!0}(e.header.type,null===(T=e.header)||void 0===T?void 0:T.size)))return;if(!u&&null!=(null===(E=e.header)||void 0===E?void 0:E.attachment)){var k=e.header.attachment.match(i.nI);if(k&&k[1]){var S=mt(decodeURIComponent(k[1])),_=(0,o.Z)(S,2);if(v=_[0],b=_[1],"break"==(u=ht(b,0)))return}}"media"==e.type&&(u=!0)}}if(u&&(i.mu[e.tabId]??=[],i.mu[i.G.tabId]??=[],!((null===(n=i.mu[e.tabId])||void 0===n?void 0:n.length)>=i.G.popListCount))){if(i.G.checkDuplicates&&i.mu[e.tabId].length<=500){var L=!0,O=!1,A=void 0;try{for(var P,R=i.mu[e.tabId][Symbol.iterator]();!(L=(P=R.next()).done);L=!0){var M=P.value;if(M.url.length==e.url.length&&M.cacheURL.pathname==l.pathname&&M.cacheURL.host==l.host&&M.cacheURL.search==l.search)return}}catch(e){O=!0,A=e}finally{try{L||null==R.return||R.return()}finally{if(O)throw A}}}!function(e,r,n){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=new URL(e.url);if(!n){var c=mt(u.pathname),l=(0,o.Z)(c,2);n=l[0],l[1]}chrome.tabs.get(e.tabId,function(){var o=a(t().mark((function a(o){var c,l,d,f,p,h,m,v,b,g;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!chrome.runtime.lastError){t.next=2;break}return t.abrupt("return");case 2:if(null!==(c=e.requestHeaders)&&void 0!==c&&c.cookie&&(e.cookie=e.requestHeaders.cookie,e.requestHeaders.cookie=void 0),null!=(m={name:n,url:e.url,size:null===(l=e.header)||void 0===l?void 0:l.size,ext:r,type:null!==(d=e.mime)&&void 0!==d?d:null===(f=e.header)||void 0===f?void 0:f.type,tabId:e.tabId,isRegex:s,requestId:null!==(p=e.requestId)&&void 0!==p?p:Date.now().toString(),extraExt:e.extraExt,initiator:e.initiator,requestHeaders:e.requestHeaders,cookie:e.cookie,cacheURL:{host:u.host,search:u.search,pathname:u.pathname}}).initiator&&"null"!=m.initiator||(m.initiator=null!==(v=null===(b=m.requestHeaders)||void 0===b?void 0:b.referer)&&void 0!==v?v:null==o?void 0:o.url),m.title=null!==(h=null==o?void 0:o.title)&&void 0!==h?h:"NULL",m.favIconUrl=null==o?void 0:o.favIconUrl,m.webUrl=null==o?void 0:o.url,s||!i.G.blackList.has(e.requestId)){t.next=11;break}return i.G.blackList.delete(e.requestId),t.abrupt("return");case 11:if(i.mu[m.tabId]??=[],i.mu[m.tabId].push(m),g={send2Popup:!0,mediaData:m,nowVideosIninfoLenths:i.mu[m.tabId].length},chrome.runtime.sendMessage(g,(function(){chrome.runtime.lastError})),!(i.mu[m.tabId].length>=100&&lt<=10)){t.next=20;break}return lt++,clearTimeout(ct),ct=setTimeout((function(){pt(m.tabId)}),5e3),t.abrupt("return");case 20:if(!(Date.now()-dt<=500)){t.next=25;break}return clearTimeout(ct),dt=Date.now(),ct=setTimeout((function(){pt(m.tabId)}),2e3),t.abrupt("return");case 25:pt(m.tabId);case 26:case"end":return t.stop()}}),a)})));return function(e){return o.apply(this,arguments)}}())}(e,b,v,s)}}}else i.G.blackList.delete(e.requestId)}else setTimeout((function(){ft(e,s,u,!0)}),211)}function pt(e){clearTimeout(ct),dt=Date.now(),lt=0,chrome.storage.local.set({MediaData:i.mu},(function(){chrome.runtime.lastError})),i.mu[e]&&ut({number:i.mu[e].length,tabId:e})}function ht(e,t){var r=i.G.Ext.get(e);return!!r&&(r.state&&!(0!=r.size&&null!=t&&t<=1024*r.size)||"break")}function mt(e){var t=decodeURI(e.split("/").pop()),r=t.split(".");return[t,(r=1==r.length?void 0:r.pop().toLowerCase())||void 0]}function vt(e){return!e||"null"==e||!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:"))}chrome.webNavigation.onBeforeNavigate.addListener((function(){})),chrome.webNavigation.onHistoryStateUpdated.addListener((function(){})),chrome.runtime.onConnect.addListener((function(e){if("HeartBeat"===e.name){e.postMessage("HeartBeat"),e.onMessage.addListener((function(e,t){}));var t=setInterval((function(){clearInterval(t),e.disconnect()}),25e4);e.onDisconnect.addListener((function(){t&&clearInterval(t)}))}})),chrome.alarms.create("nowClear",{when:Date.now()+3e3}),chrome.alarms.create("clear",{periodInMinutes:60}),chrome.alarms.onAlarm.addListener((function(e){"nowClear"!==e.name&&"clear"!==e.name?"save"!==e.name||chrome.storage.local.set({MediaData:i.mu}):(0,i.YA)()})),chrome.webRequest.onBeforeRequest.addListener((function(e){try{ft(e,!0)}catch(e){}}),{urls:["<all_urls>"]},["requestBody"]),chrome.webRequest.onSendHeaders.addListener((function(e){if(!i.G||i.G.enable){var t=function(e){if(null==e.requestHeaders||0==e.requestHeaders.length)return!1;var t={},r=!0,n=!1,a=void 0;try{for(var o,i=e.requestHeaders[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var s=o.value;t[s.name]=s.value,s.name=s.name.toLowerCase(),"referer"==s.name?t.referer=s.value.toLowerCase():"origin"==s.name?t.origin=s.value.toLowerCase():"cookie"==s.name&&(t.cookie=s.value.toLowerCase())}}catch(e){n=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}if(Object.keys(t).length)return t;return!1}(e);t&&i.G.requestHeaders.set(e.requestId,t)}}),{urls:["<all_urls>"]},["requestHeaders",chrome.webRequest.OnBeforeSendHeadersOptions.EXTRA_HEADERS].filter(Boolean)),chrome.webRequest.onResponseStarted.addListener((function(e){try{var t=i.G.requestHeaders.get(e.requestId);t&&(e.requestHeaders=t,i.G.requestHeaders.delete(e.requestId)),ft(e)}catch(e){}}),{urls:["<all_urls>"]},["responseHeaders"]),chrome.webRequest.onErrorOccurred.addListener((function(e){i.G.requestHeaders.delete(e.requestId),i.G.blackList.delete(e.requestId)}),{urls:["<all_urls>"]}),chrome.runtime.onMessage.addListener((function(e,t,r){var n,a;if(!i.G.initLocalComplete||!i.G.initSyncComplete)return r("error"),!0;if("pushData"==e.Message)return chrome.storage.local.set({MediaData:i.mu}),r("ok"),!0;if("getAllData"==e.Message)return r(i.mu),!0;if("ClearIcon"==e.Message)return e.type?i.G.tabId&&ut({tabId:i.G.tabId}):ut({tips:!1}),r("ok"),!0;if("enable"==e.Message)return i.G.enable=!i.G.enable,chrome.storage.sync.set({enable:i.G.enable}),chrome.action.setIcon({path:i.G.enable?"assets/icons/64x64.png":"assets/icons/64x64_gray.png"}),r(i.G.enable),!0;if(e.tabId=null!==(n=e.tabId)&&void 0!==n?n:i.G.tabId,"getData"==e.Message)return r(i.mu[e.tabId]),!0;if("getOneVideoInfo"==e.Message)return r(i.mu[e.tabId][e.oneVideoInfoIndex]),!0;if("getOneTabVideosLength"==e.Message)return r((null===(a=i.mu[e.tabId])||void 0===a?void 0:a.length)||0),!0;if("getButtonState"==e.Message){var o={MobileUserAgent:i.G.featMobileTabId.has(e.tabId),enable:i.G.enable};return i.G.scriptList.forEach((function(t,r){o[t.key]=t.tabId.has(e.tabId)})),r(o),!0}if("mobileUserAgent"==e.Message)return function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return i.G.featMobileTabId.add(e),chrome.storage.local.set({featMobileTabId:Array.from(i.G.featMobileTabId)}),chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[e],addRules:[{id:e,action:{type:"modifyHeaders",requestHeaders:[{header:"User-Agent",operation:"set",value:i.G.MobileUserAgent}]},condition:{tabIds:[e],resourceTypes:Object.values(chrome.declarativeNetRequest.ResourceType)}}]}),!0;i.G.featMobileTabId.delete(e)&&chrome.storage.local.set({featMobileTabId:Array.from(i.G.featMobileTabId)}),chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[e]})}(e.tabId,!i.G.featMobileTabId.has(e.tabId)),chrome.tabs.reload(e.tabId,{bypassCache:!0}),r("ok"),!0;if("script"==e.Message){var s;if(!i.G.scriptList.has(e.script))return r("error no exists"),!1;var u=i.G.scriptList.get(e.script),c=u.tabId,l=null!==(s=e.refresh)&&void 0!==s?s:u.refresh;return c.has(e.tabId)?(c.delete(e.tabId),l&&chrome.tabs.reload(e.tabId,{bypassCache:!0}),r("ok"),!0):(c.add(e.tabId),l?chrome.tabs.reload(e.tabId,{bypassCache:!0}):chrome.scripting.executeScript({target:{tabId:e.tabId,allFrames:u.allFrames},files:["assets/js/"+e.script],injectImmediately:!0,world:u.world}),r("ok"),!0)}if("HeartBeat"==e.Message)return chrome.tabs.query({active:!0,currentWindow:!0},(function(e){e[0]&&e[0].id&&(i.G.tabId=e[0].id)})),r("HeartBeat OK"),!0;if("clearData"==e.Message){if(e.type)return delete i.mu[e.tabId],chrome.storage.local.set({MediaData:i.mu}),(0,i.YA)(),r("OK"),!0;for(var d in i.mu)d!=e.tabId&&delete i.mu[d];return chrome.storage.local.set({MediaData:i.mu}),(0,i.YA)(),r("OK"),!0}if("clearRedundant"==e.Message)return(0,i.YA)(),r("OK"),!0;if("addMedia"==e.Message)return chrome.tabs.query({},(function(t){var r=!0,n=!1,a=void 0;try{for(var o,i=t[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var s=o.value;if(s.url==e.href)return void ft({url:e.url,tabId:s.id,extraExt:e.extraExt,mime:e.mime,requestId:e.requestId,requestHeaders:e.requestHeaders},!0,!0)}}catch(e){n=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}ft({url:e.url,tabId:-1,extraExt:e.extraExt,mime:e.mime,requestId:e.requestId,initiator:e.href,requestHeaders:e.requestHeaders},!0,!0)})),void r("ok");if("screenRecorderStoped"==e.Message){var f=t.tab.id,p=i.G.scriptList.get("screenrecorder.js").tabId;p.has(f)&&p.delete(f)}"tellScreenRecorderStop"==e.Message&&chrome.tabs.query({active:!0,currentWindow:!0}).then((function(t){var r=t[0].id;r&&chrome.tabs.sendMessage(r,{Message:"scriptTabidRemoved",scriptName:e.script})}))})),chrome.tabs.onHighlighted.addListener((function(e){e.tabId&&-1!=e.tabId&&(i.G.tabId=e.tabId)})),chrome.tabs.onActivated.addListener((function(e){i.G.tabId=e.tabId,void 0===i.mu[i.G.tabId]?ut({tabId:i.G.tabId}):ut({number:i.mu[i.G.tabId].length,tabId:i.G.tabId})})),chrome.windows.onFocusChanged.addListener((function(e){e.tabId&&-1!=e.tabId&&(i.G.tabId=e.tabId)}),{filters:["normal"]}),chrome.tabs.onUpdated.addListener((function(e,t,r){var n;vt(r.url)||e<=0||!i.G.initSyncComplete||(t.status&&"loading"==t.status&&2==i.G.autoClearMode&&chrome.alarms.get("save",(function(t){if(!t){var n;if(i.mu[e]&&i.mu[e].length>0)(null===(n=i.mu[e][0])||void 0===n?void 0:n.webUrl)!=r.url&&delete i.mu[e];ut({tabId:e}),chrome.alarms.create("save",{when:Date.now()+1e3})}})),ut({number:null===(n=i.mu[e])||void 0===n?void 0:n.length,tabId:e}))})),chrome.webNavigation.onCompleted.addListener(function(){var e=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A(r.url)&&st(r.tabId);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),chrome.webNavigation.onCommitted.addListener(function(){var e=a(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(r.url)&&st(r.tabId),!(vt(r.url)||r.tabId<=0)&&i.G.initSyncComplete){e.next=3;break}return e.abrupt("return");case 3:if(0!=r.frameId||"reload"!=r.transitionType&&"link"!=r.transitionType||1!=i.G.autoClearMode||(delete i.mu[r.tabId],chrome.storage.local.set({MediaData:i.mu}),ut({tabId:r.tabId})),!(i.G.version<102)){e.next=6;break}return e.abrupt("return");case 6:i.G.scriptList.forEach((function(e,t){if(!e.tabId.has(r.tabId)||!e.allFrames)return!0;chrome.scripting.executeScript({target:{tabId:r.tabId,frameIds:[r.frameId]},files:["assets/js/".concat(t)],injectImmediately:!0,world:e.world})})),i.G.initLocalComplete&&i.G.featMobileTabId.size>0&&i.G.featMobileTabId.has(r.tabId)&&chrome.scripting.executeScript({args:[i.G.MobileUserAgent.toString()],target:{tabId:r.tabId,frameIds:[r.frameId]},func:function(){Object.defineProperty(navigator,"userAgent",{value:arguments[0],writable:!1})},injectImmediately:!0,world:"MAIN"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),chrome.tabs.onRemoved.addListener((function(e){chrome.alarms.get("nowClear",(function(e){!e&&chrome.alarms.create("nowClear",{when:Date.now()+1e3})})),ce.removeTabById(e),i.G.customFoundUrls.delete(e)})),chrome.commands.onCommand.addListener(function(){var e=a(t().mark((function e(r){var n,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){},"force-download"!==r){e.next=12;break}return e.next=4,ie();case 4:if(!e.sent){e.next=8;break}chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){var t,r,a=e[0],o=i.mu[a.id],s=!0,u=!1,c=void 0;try{for(var l,d=o[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var f=l.value;if(le(f)){t=f.url,r=de(f,i.G);break}}}catch(e){u=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(u)throw c}}Me({m3u8Url:t,fileName:r},n)})),e.next=12;break;case 8:return e.next=10,X();case 10:a=e.sent,chrome.tabs.create({url:a+"/needpro.html",active:!0});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ot(),$e(),Qe(),Ge()})()})();